<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">

<th:block layout:fragment="content">
    <h1>My Repositories</h1>
    <p>Select repositories to track for your growth log.</p>

    <ul class="list-group">
        <li th:each="repo : ${repos}" class="list-group-item d-flex justify-content-between align-items-center">
            <div>
                <a th:href="@{/repositories/{owner}/{repo}/commits(owner=${repo.owner.login}, repo=${repo.name})}">
                    <h5 class="mb-1" th:text="${repo.name}">Repo Name</h5>
                </a>
                <p class="mb-1" th:text="${repo.description}">Repo Description</p>
            </div>
            <div>
                <form th:if="${trackedRepoNames.contains(repo.name)}" th:action="@{/user/repositories/remove}" method="post" style="display: inline;">
                    <input type="hidden" name="repoName" th:value="${repo.name}"/>
                    <button type="submit" class="btn btn-danger btn-sm" data-bs-toggle="tooltip" data-bs-placement="top" title="이 리포지토리 추적을 중단합니다.">Untrack</button>
                </form>
                <form th:unless="${trackedRepoNames.contains(repo.name)}" th:action="@{/user/repositories/add}" method="post" style="display: inline;">
                    <input type="hidden" name="repoName" th:value="${repo.name}"/>
                    <button type="submit" class="btn btn-success btn-sm" data-bs-toggle="tooltip" data-bs-placement="top" title="이 리포지토리를 추적 목록에 추가합니다.">Track</button>
                </form>
            </div>
        </li>
    </ul>
</th:block>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
    });
</script>
</html>