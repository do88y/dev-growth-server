<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Commits</title>
</head>
<body>
<h1>Commits for <span th:text="${repoName}"></span></h1>

<div th:if="${successMessage}" style="color: green;">
    <p th:text="${successMessage}"></p>
</div>
<div th:if="${errorMessage}" style="color: red;">
    <p th:text="${errorMessage}"></p>
</div>

<table>
    <thead>
    <tr>
        <th>SHA</th>
        <th>Author</th>
        <th>Message</th>
        <th>Date</th>
        <th>Lines Added</th>
        <th>Lines Deleted</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="commit : ${commits}">
        <td><a th:href="${commit.diffUrl}" th:text="${#strings.substring(commit.commitHash, 0, 7)}" target="_blank"></a></td>
        <td th:text="${commit.user.nickname}"></td>
        <td th:text="${commit.message}"></td>
        <td th:text="${commit.commitDate}"></td>
        <td th:text="${commit.linesAdded}"></td>
        <td th:text="${commit.linesDeleted}"></td>
        <td>
            <form th:action="@{/commits/{commitId}/evaluate(commitId=${commit.id})}" method="post">
                <button type="submit" th:disabled="${commit.evaluationStatus == T(com.devgrowth.project.model.CommitLog.EvaluationStatus).EVALUATED}">AI Evaluate</button>
            </form>
        </td>
    </tr>
    <tr th:each="commit : ${commits}" th:if="${commit.evaluationResult}">
        <td colspan="7">
            <strong>AI Evaluation:</strong> <span th:text="${commit.evaluationResult}"></span>
        </td>
    </tr>
    </tbody>
</table>

<a href="/repositories">Back to Repositories</a>
</body>
</html>